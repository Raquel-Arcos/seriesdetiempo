---
title: "Visualizing Time Series Data in R"
subtitle: "El segundo curso en el programa de series de tiempo de DataCamp"
author: "Raquel Arcos Bulos"
date: "Diciembre 2019"
fig_width: 5
fig_height: 3
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
output: 
        html_document:
            keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

## Introducción

Este documento reúne los gráficos generados en el curso [Visualizing Time Series Data in R](https://www.datacamp.com/courses/visualizing-time-series-data-in-r) de [DataCamp](https://www.datacamp.com/). Este curso forma parte del track [Time Series with R](https://www.datacamp.com/tracks/time-series-with-r) de esta compañía.     
Tiene por objeto construir un archivo en _R Markdown_ que pueda ser visto como una página web por los visitantes de _Git Hub_ sin que deban descargar archivo alguno ni correr código en R. El usuario en Git Hub es Raquel-Arcos.

La conexión entre _R Studio_ y _Git Hub_ se realiza a través de los implementos que el IDE tiene para ello.

El diseño especial que tienen los gráficos se logra gracias a la librería _PerformanceAnalytics_



```{r echo=FALSE, warning=FALSE}
library(dplyr)
library(xts)
library(zoo)
library(PerformanceAnalytics)
library(TTR)
```

```{r}
rm(list = ls())
data <- read.csv.zoo("dataset_1_1.csv", header = TRUE, sep = "", index.column=1, format="%Y-%m-%d")
data <- as.xts(data)
# Display the first few lines of the data
head(data, n=3)

# Display the column names of the data
tail(data, n=3)
```

## Los datos
El primer archivo contiene los precios de acciones diarios de cuatro importantes compañías: Yahoo, Microsoft, Citigroup y Dow Chemical en el periodo enero-2015 a diciembre 2016. A continuación se presentan las series de tiempo para cada compañía contrastando los precios vs las fechas.

```{r pedazo1, fig.align="center", fig.cap="Gráfica_1"}
# Also reduce margin and character sizes by half
par(mfrow = c(1, 1), mex = 0.6, cex = 0.3)

# Replot yahoo data with labels for X and Y axes
plot(data$yahoo, main="Yahoo", type = "l", lwd = 2, las=1, xlab="date", ylab="price", col="dodgerblue4")
```

```{r pedazo2, fig.align="center", fig.cap="Gráfica_2"}
par(mfrow = c(1, 1), mex = 0.6, cex = 0.3)
# Plot the second time series and change title
plot(data$microsoft, main="Microsoft", type = "l", lwd = 2, lty=2, las=1, xlab="date", ylab="price", col="darkgreen")
```

```{r pedazo3, fig.align="center", fig.cap="Gráfica_3" }
par(mfrow = c(1, 1), mex = 0.6, cex = 0.3)
# Plot the second time series and change title
plot(data$citigroup, main="Citigroup", type = "l", lwd = 2, las=1, xlab="date", ylab="price", col="darkorange")
```

```{r pedazo4, fig.align="center", fig.cap="Gráfica_4"}
par(mfrow = c(1, 1), mex = 0.6, cex = 0.3)
# Plot the second time series and change title
plot(data$dow_chemical, main="Dow chemical", type = "l", lwd = 2, las=1, xlab="date", ylab="price", col="darkmagenta")
```


```{r pedazo5,  fig.align="center", fig.cap="Gráfica_5" }
# Change line color to red
plot(data$microsoft, type = "h", col="grey", main="microsoft", sub="Daily closing price since 2015", las=1, xlab="date", ylab="price")
lines(data$microsoft, col = "green")
```


```{r pedazo6, fig.align="center", fig.cap="Gráfica_6" }
# Plot the "microsoft" series
plot(data$microsoft, type = "l", las=1, main="Stock prices since 2015")

# Add the "dow_chemical" series in red
lines(data$dow_chemical, col = "dodgerblue4")

# Add a legend in the bottom right corner
legend(x = "bottomright", legend = c("microsoft", "dow_chemical"),col = c("black", "red"), lty = c(1, 1)) 
```

```{r pedazo7, fig.align="center", fig.cap="Gráfica_7" }
# Plot the "citigroup" time series
plot(data$citigroup, type = "l", las=1, main="Citigroup")

# Create vert_line to identify January 4th, 2016 in citigroup
vert_line <- which(index(data) == as.Date("2016-01-04"))

# Add a red vertical line using vert_line
abline(v = .index(data)[vert_line], col = "red")

# Create hori_line to identify average price of citigroup
hori_line <- mean(data$citigroup)

# Add a blue horizontal line using hori_line
abline(h = hori_line, col = "blue")
```

```{r pedazo8, fig.align="center", fig.cap="Gráfica_8"}
# Create period to hold the 3 months of 2015
period <- c("2015-01/2015-03")

# Highlight the first three months of 2015 
chart.TimeSeries(data$citigroup, period.areas = period)
```
```{r}
# Highlight the first three months of 2015 in light grey
chart.TimeSeries(data$citigroup, period.areas = period, period.color="blue")
```


```{r pedazo9, fig.align="center", fig.cap="Gráfica_9"}
# Same plot as the previous exercise
plot(data$microsoft, main = "Dividend date and amount", las=1, xlab = "date")
lines(data$citigroup, col = "orange", lwd = 2)


# Create the legend in the bottom right corner
legend(x = "bottomright", legend = c("micro", "citi"), col = c("black", "orange"), lty = c(1, 1))

```

```{r}
rm(list = ls())
data1 <- read.csv("dataset_2_1.csv", header = TRUE, sep = "")
names(data1)
data2<-read.zoo(data1, index.column = 1, format ="%Y-%m-%d")
data<-as.xts(data2)
colnames(data)<-"apple"
```

```{r}
#Plot Apple's stock price 
plot(data$apple, type = "l", las=1, main = "Apple stock price", xlab ="date")
```

```{r}
# Create a time series called rtn
rtn<-ROC(data$apple)

# Plot Apple daily price and daily returns 
par(mfrow = c(2, 1), mex = 0.6, cex = 0.5)

plot(data$apple, las=1, main = "Apple stock price", xlab ="date")
plot(rtn, col = "forestgreen", main="RTN Apple stock price") 
```

```{r}
# Create a histogram of Apple stock returns
hist(rtn,
     breaks = 20,
     main = "Apple stock return distribution",
     xlab = "",
     probability=TRUE,
     col = "darkslategray1")
# Redraw a thicker, red density line
lines(density(rtn[-1,]), col="deeppink", lwd=2, lty=2)
```

```{r}
data(edhec)
class(edhec)
indice <- index(edhec)
```











